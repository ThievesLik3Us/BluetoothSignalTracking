<!doctype html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<link type="text/css" href="./bootstrap-4.3.1-dist/css/bootstrap.css" rel="stylesheet" />
	<link type="text/css" href="custom.css" rel="stylesheet" />
	<!--<link type="text/css" href="./bootstrap-4.3.1-dist/css/bootstrap.min.css" rel="stylesheet" />-->
	<!--<link type="text/css" href="./jquery/css/vader/jquery-ui.css" rel="stylesheet" />-->

	<title>Signal Monitor (beta)</title>
	<script type="text/javascript" src="support.js"></script>
	<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAy7XIg38gprgX1z6UXqc4wixEOVjWcsas&callback=initialize"></script>
	
	<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.css"/>

	<script type="text/javascript">
	$(function() {
	$("#menu-toggle").click( function() { 
		$("#main-menu").toggleClass("d-none") ; 
		$("#menu-toggle").toggleClass("btn-danger").toggleClass("btn-outline-primary") ; 
	});
	
	var expDateInput = $("#expDate") ;
	var expForm = $("body") ;
	var expDateOpt = {
		format: 'mm/dd/yyyy',
		container: expForm,
		todayHighlight: true,
		autoclose: true,
	} ;
	expDateInput.datepicker(expDateOpt) ;
	
	$('#expTest').on('submit', function(e) {
		e.preventDefault();
		var formData = {
			'place'	: $("#expPlace").val(),
			'date' 	: $("#expDate").val(),
			'time' 	: $("#expTime").val(),
			'lat'	: $("#expLat").val(),
			'lng'	: $("#expLng").val()
		};
		
		$.ajax({
			url : $(this).attr('action'),
			type: "POST",
			data: formData,
			dataType: 'script',
			error: function (jXHR, textStatus, errorThrown) {
				alert(errorThrown);
			}
		});
	});
	
	$('#showExp').click(function(e) {	
		$.ajax({
			url : $(this).attr('action'),
			type: "GET",
			dataType: 'script',
			error: function (jXHR, textStatus, errorThrown) {
				alert(errorThrown);
			}
		});
	});
	
	var exp_mm_listen ;
	var exp_cl_listen ;
	var exp_marker ;
	var expLat = $("#expLat") ;
	var expLng = $("#expLng") ;
	$("#btn-collapseOne").click( function() {
		if(!exp_cl_listen)
		{
			exp_mm_listen = google.maps.event.addListener(map, "mousemove", function(event) {
				expLat.val(event.latLng.lat().toFixed(10)) ; 
				expLng.val(event.latLng.lng().toFixed(10)) ;
			}) ;
			exp_cl_listen = google.maps.event.addListener(map, "click", function(event) {
				if(!exp_mm_listen)
				{
					exp_mm_listen = google.maps.event.addListener(map, "mousemove", function(event) {
						expLat.val(event.latLng.lat().toFixed(10)) ; 
						expLng.val(event.latLng.lng().toFixed(10)) ;
					}) ;
					exp_marker.setMap(null) ;
					exp_marker = null ;
					expLat.val(event.latLng.lat().toFixed(10)) ; 
					expLng.val(event.latLng.lng().toFixed(10)) ;
				} else {
					google.maps.event.clearListeners(map, "mousemove") ;
					exp_mm_listen = null ;
					exp_marker = new google.maps.Marker({
						position:	event.latLng,
						icon:		"./image/icons8-down-arrow-64.png",
						draggable:	false,
						animation:	google.maps.Animation.DROP,
						map:		map
					}) ;
					expLat.val(event.latLng.lat().toFixed(10)) ; 
					expLng.val(event.latLng.lng().toFixed(10)) ;
				}
			}) ;
			output.push() ;
			output.add("Mouse Trace event activated...") ;
			output.timestamp() ;
		} else {
			google.maps.event.clearListeners(map, "mousemove") ;
			google.maps.event.clearListeners(map, "click") ;
			if(exp_marker)
				exp_marker.setMap(null) ;
			exp_mm_listen = null ;
			exp_cl_listen = null ;
			exp_marker = null ;
			output.push() ;
			output.add("Mouse Trace event removed.") ;
			output.timestamp() ;
		}
	});
	
	$("#output-expand").hover( function() { $(this).css("background","#dcdcdc").find("img").toggleClass("d-none"); },
								function() { $(this).css("background","#17202a").find("img").toggleClass("d-none"); })
			.mousedown( function() { $(this).css("background","#bd2130").find("img").toggleClass("d-none"); })
			.mouseup( function() { $(this).css("background","#dcdcdc").find("img").toggleClass("d-none"); });
			
	$("#output-minimize").hover( function() { $(this).css("background","#dcdcdc").find("img").toggleClass("d-none"); },
							   function() { $(this).css("background","#17202a").find("img").toggleClass("d-none"); })
			.mousedown( function() { $(this).css("background","#bd2130").find("img").toggleClass("d-none"); })
			.mouseup( function() { $(this).css("background","#dcdcdc").find("img").toggleClass("d-none"); });
	
	$("#output-remove").hover( function() { $(this).css("background","#dcdcdc").find("img").toggleClass("d-none"); },
							   function() { $(this).css("background","#17202a").find("img").toggleClass("d-none"); })
			.mousedown( function() { $(this).css("background","#bd2130").find("img").toggleClass("d-none"); })
			.mouseup( function() { $(this).css("background","#dcdcdc").find("img").toggleClass("d-none"); });
	});
	</script>
</head>
<body class="bg-main">
	<div class="container-fluid">
    <div class="row">
		<!-- Left Column -->
        <div class="col-md-2">
				<div class="card menu-toggle">
				<button id="menu-toggle" class="btn btn-outline-primary" type="button">
					Menu
				</button>
				</div>
           		<div class="sidebar-nav-fixed affix">
               	<div class="card card-body bg-light">
					<div class="btn-group-vertical" role="group" aria-label="First group">
						<button id="showExp" type="button" action="./php/exp_test.php" class="btn btn-secondary">Show Experiments</button>
						<button id="showDev" type="button" class="btn btn-secondary">Show Devices</button>
						<button id="showRssi" type="button" class="btn btn-secondary">Show RSSI</button>
						<button type="button" class="btn btn-secondary">Extra Button</button>
					</div>
               	</div>
           		</div>
        </div>
		<!-- / Left Column -->
		<!-- Middle Column -->
        <div class="col-md-8">
			<!-- Top Menu -->
			<nav id="main-menu" class="navbar navbar-expand-lg navbar-dark bg-primary d-none">
				<div id="navbarColor01" class="collapse navbar-collapse col-md-10" >
					<ul class="navbar-nav mr-auto">
					<li class="nav-item active">
						<a class="nav-link" href="#">Home</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">Features</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">Pricing</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">About</a>
					</li>
					</ul>
				</div>
			</nav>
			<!-- / Top Menu -->
			
			<!-- Map Content -->
			<div class="top-column">
           	<div id="map">
			</div>
			</div>
			<!-- / Map Content -->
			
			<!-- Message Console -->
			<div id="output" class="bg-dark text-success">
				<div class="full-h">
					<div id="output-margin">
						<p class="text-right">Console-></p>
					</div>
					<div id="output-main">
					
						<div id="output-content">
						
							<div id="output-recent">
							<p id="p-recent" class="text-left">
							</p></div>
							
							<div id="output-history">
							<p id="p-history" class="text-left text-success">
							</p></div>
							
						</div>
						
						<div id="output-controls" class="rounded-NE">
							<div id="output-expand" class="btn-square rounded-NE">
								<img src="./image/baseline_fullscreen_white_18dp.png" />
								<img src="./image/baseline_fullscreen_black_18dp.png" class="d-none" />
							</div>
							<div id="output-minimize" class="btn-square rounded-NE d-none">
								<img src="./image/baseline_fullscreen_exit_white_18dp.png" />
								<img src="./image/baseline_fullscreen_exit_black_18dp.png" class="d-none" />
							</div>
							<div id="output-remove" class="btn-square">
								<img src="./image/baseline_close_white_18dp.png" />
								<img src="./image/baseline_close_black_18dp.png" class="d-none" />
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- / Message Console -->
			
        </div>
        <!-- / Middle Column -->

		<!-- Right Column -->
    	<div class="col-md-2 top-column">
			<div class="sidebar-nav-fixed pull-right affix">
               	<div class="card card-body bg-light" style="padding: 0.25rem">
               		<div id="accordionExample" class="accordion">
						<div id="headingOne" class="card">
							<h2 class="mb-0">
								<button id="btn-collapseOne" class="btn btn-secondary btn-block collapsed" type="button" data-toggle="collapse" data-target="#collapseOne">
									Experiment Test Entry
								</button>
							</h2>
							<div id="collapseOne" class="collapse" data-parent="#accordionExample">
								<div class="card-body" style="padding: 0.5rem 0.25rem">
									<form id="expTest" action="./php/exp_test.php" method="post">
										<div class="form-group" style="margin-bottom: 0.5rem">
											<input id="expPlace" class="form-control" type="text" name="place" placeholder="Place" required>
										</div>
									    <div class="form-group" style="margin-bottom: 0.5rem">
											<input id="expDate" class="form-control" type="text" name="date" placeholder="MM/DD/YYYY" required>
									    </div>
										<div class="form-group" style="margin-bottom: 0.5rem">
											<input id="expTime" class="form-control" type="time" name="time" step="1" placeholder="00:00:00" required>
									    </div>
										<div class="form-group" style="margin-bottom: 0.5rem">
											<span>Lat:</span><input id="expLat" class="form-control" type="text" name="lat" placeholder="0.0" readonly required>
									    </div>
										<div class="form-group" style="margin-bottom: 0.5rem">
											<span>Lng:</span><input id="expLng" class="form-control" type="text" name="lng" placeholder="0.0" readonly required>
										</div>
										<button id="expSubmit" type="submit" class="btn btn-primary">Submit Entry</button>
									</form>
								</div>
							</div>
						</div>
						<div id="headingTwo" class="card">
							<h2 class="mb-0">
								<button id="btn-collapseTwo" class="btn btn-secondary btn-block collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
									Device Test Entry
								</button>
							</h2>
							<div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
								<div class="card-body">
									More Data in this one...
								</div>
							</div>
						</div>
						<div id="headingThree" class="card">
							<h2 class="mb-0">
								<button id="btn-collapseThree" class="btn btn-secondary btn-block collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
									RSSI Test Entry
								</button>
							</h2>
							<div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
								<div class="card-body">
									I don't know what to put here.
								</div>
							</div>
						</div>
					</div>
                </div>
                <!--/.well -->
            </div>
            <!--/sidebar-nav-fixed -->
        </div>
        <!-- / Right Column -->
		
    </div>
    <!--/row-->
	</div>
	<!--/.fluid-container-->
<div id="tooltip" class="tooltip fade bs-tooltip-top d-none" role="tooltip"  style="will-change: transform; position: absolute; transform: translate3d(50vw, 50vh, 0px); top: 0px; left: 0px;" x-placement="top">
	<div class="arrow" style="left: 45px;"></div>
	<div class="tooltip-inner">Tooltip on top</div>
</div>
</body>
</html>